# AgentGateway Configuration
# P0-004: Agent Traffic Plane Gateway

server:
  host: 0.0.0.0
  port: 8090
  admin_port: 8091
  metrics_port: 8092
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s

logging:
  level: info
  format: json
  output: stdout

# Upstream services
upstreams:
  localai:
    url: http://localai:8080
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s

  kong:
    admin_url: http://kong:8001
    proxy_url: http://kong:8000
    timeout: 10s

# MCP (Model Context Protocol) Configuration
mcp:
  enabled: true
  transports:
    - stdio
    - http
  max_message_size: 10485760  # 10MB
  timeout: 60s

# Rate limiting
rate_limit:
  enabled: true
  requests_per_second: 100
  burst: 200

# Connection pooling
connection_pool:
  max_idle_conns: 100
  max_idle_conns_per_host: 10
  max_conns_per_host: 100
  idle_conn_timeout: 90s

# Health check configuration
health:
  enabled: true
  interval: 10s
  timeout: 5s
  unhealthy_threshold: 3
  healthy_threshold: 2

# Circuit breaker
circuit_breaker:
  enabled: true
  threshold: 5
  timeout: 60s
  max_requests: 10

# Metrics and observability
metrics:
  enabled: true
  path: /metrics
  namespace: agentgateway

# Security
security:
  cors:
    enabled: true
    allowed_origins:
      - "*"
    allowed_methods:
      - GET
      - POST
      - PUT
      - DELETE
      - OPTIONS
    allowed_headers:
      - "*"
    expose_headers:
      - X-Request-ID
    max_age: 3600

  tls:
    enabled: false
    cert_file: ""
    key_file: ""

# Request routing
routes:
  - name: localai_inference
    path: /v1/*
    upstream: localai
    methods: [GET, POST]
    timeout: 30s

  - name: localai_models
    path: /models/*
    upstream: localai
    methods: [GET]
    timeout: 10s

  - name: health
    path: /health
    type: internal
    methods: [GET]
